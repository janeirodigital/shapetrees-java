statusCode: 200
delay: 0
headers:
  - 'Content-type:text/turtle'
body: >
  @prefix st: <http://www.w3.org/ns/shapetrees#> .
  @prefix ecos: <${SERVER_BASE}/static/shex/solid-interop/shex#> .

  # Agent
  ##############################################################################
    <#profile-tree>
    a st:ShapeTree;
    st:expectsType st:Container ;
    st:contains <#agent-tree> ,
    st:AllowAll .

    <#agent-tree>
    a st:ShapeTree;
    st:expectsType st:Resource ;
    st:validatedBy ecos:AgentShape ;
    st:matchesUriTemplate "id" .

    # Registrar
    ##############################################################################
    <#registrar-tree>
    a st:ShapeTree;
    st:expectsType st:Container ;
    st:validatedBy ecos:RegistrarShape ;
    st:contains <#application-registry-set-tree> ,
    <#data-registry-set-tree> ,
    st:AllowOnly .

    <#application-registry-set-tree>
    a st:ShapeTree;
    st:expectsType st:Resource ;
    st:validatedBy ecos:ApplicationRegistrySetShape ;
    st:matchesUriTemplate "application" .

    <#data-registry-set-tree>
    a st:ShapeTree;
    st:expectsType st:Resource ;
    st:validatedBy ecos:DataRegistrySetShape ;
    st:matchesUriTemplate "data" .

    # Application Registry
    ##############################################################################
    # Ensure the registry container graph contains a valid
    # ApplicationRegistry instance, and the resource inside of
    # it are valid ApplicationRegistration instances.
    ##############################################################################
    <#application-registry-tree>
    a st:ShapeTree;
    st:expectsType st:Container ;
    st:validatedBy ecos:ApplicationRegistryShape ;
    st:contains <#application-registration-tree> ,
    st:AllowOnly .

    # Application Registration
    ##############################################################################
    # Ensure the registration container graph contains a valid
    # ApplicationRegistration instance. Applications have freedom to store
    # whatever data internal to their operation that they like within
    ##############################################################################
    <#application-registration-tree>
    a st:ShapeTree;
    st:expectsType st:Container ;
    st:validatedBy ecos:ApplicationRegistrationShape ;
    st:matchesUriTemplate "{id}" .

    # Data Registry
    ##############################################################################
    # Ensure the registry container graph contains a valid
    # DataRegistry instance, and the resource inside of
    # it are valid DataRegistration instances.
    ##############################################################################
    <#data-registry-tree>
    a st:ShapeTree;
    st:expectsType st:Container ;
    st:validatedBy ecos:DataRegistryShape ;
    st:contains <#data-registration-tree> ,
    st:AllowOnly .

    # Data Registration
    ##############################################################################
    # Ensure the registration container graph contains a valid
    # DataRegistration instance, which will in turn contain instances of
    # whatever shape tree was registered by the eco:DataRegistration.
    ##############################################################################
    <#data-registration-tree>
    a st:ShapeTree;
    st:expectsType st:Container ;
    st:validatedBy ecos:DataRegistrationShape ;
    st:matchesUriTemplate "{id}" .